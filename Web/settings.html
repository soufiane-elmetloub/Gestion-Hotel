<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Smart Hotel</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts - Cairo -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Shared Layout Styles -->
    <link href="assets/layout.css" rel="stylesheet">
    <style>
        :root { --primary-color:#4e73df; --secondary-color:#1cc88a; --danger-color:#e74a3b; --warning-color:#f6c23e; --info-color:#36b9cc; --light-color:#f8f9fc; --dark-color:#5a5c69; }
        body { font-family:'Cairo',sans-serif; background-color:var(--light-color); min-height:100vh; }
        .navbar { background:linear-gradient(135deg, var(--primary-color) 0%, #2e59d9 100%); box-shadow:0 2px 10px rgba(0,0,0,.1); }
        .navbar .search-center { position:absolute; left:50%; transform:translateX(-50%); width:min(640px, calc(100% - 360px)); display:flex; align-items:center; gap:8px; }
        .navbar .container-fluid { position:relative; }
        .navbar .search-center .search-box { position:relative; width:100%; }
        .navbar .search-center .search-box input { width:100%; height:38px; border-radius:9999px; border:none; outline:none; padding:0 44px; background:rgba(255,255,255,.9); color:#1b1e23; box-shadow: inset 0 0 0 1px rgba(255,255,255,.65), 0 4px 10px rgba(0,0,0,.12); }
        .navbar .search-center .search-box .icon-left, .navbar .search-center .search-box .icon-right { position:absolute; top:50%; transform:translateY(-50%); color:#6b7280; }
        .navbar .search-center .search-box .icon-left { left:14px; }
        .navbar .search-center .search-box .icon-right { right:12px; }
        @media (max-width:576px){ .navbar .search-center{ width:75%; } .navbar .search-center .search-box input{ height:34px; } }
        /* Sidebar */
        .sidebar { position:fixed; top:0; left:0; height:100vh; width:260px; background:linear-gradient(180deg, #2e59d9 0%, var(--primary-color) 65%); color:#fff; box-shadow:4px 0 18px rgba(0,0,0,.12); z-index:1041; padding-top:0; overflow-y:auto; border-top-right-radius:16px; border-bottom-right-radius:16px; transition:width .25s ease; }
        body.sidebar-collapsed .sidebar { width:80px; }
        body.sidebar-collapsed .content-wrapper { margin-left:80px; }
        @media (min-width:992px){ .navbar{ padding-left:260px; } body.sidebar-collapsed .navbar{ padding-left:80px; } }
        body.sidebar-collapsed .sidebar .brand-name { display:none; }
        body.sidebar-collapsed .sidebar .menu a { justify-content:center; }
        body.sidebar-collapsed .sidebar .menu a .label { display:none; }
        body.sidebar-collapsed .sidebar .menu a .icon { margin-right:0; }
        body.sidebar-collapsed .sidebar-header { justify-content:center; }
        body.sidebar-collapsed .sidebar-header .brand-logo { height:28px; }
        @media (max-width:991.98px){ body.sidebar-collapsed .sidebar{ width:260px; } body.sidebar-collapsed .content-wrapper{ margin-left:0; } }
        .sidebar-header { display:flex; align-items:center; gap:10px; padding:.2rem .9rem .65rem; margin-bottom:.1rem; border-bottom:1px dashed rgba(255,255,255,.25); position:sticky; top:0; z-index:1; background:linear-gradient(180deg, #2e59d9 0%, rgba(46,89,217,.92) 70%); }
        .brand-logo { height:42px; width:auto; object-fit:contain; filter:brightness(0) invert(1); }
        .brand-name { font-weight:700; font-size:1.3rem; line-height:1.2; }
        .sidebar-collapse-btn { margin-left:auto; background:rgba(255,255,255,.15); border:1px solid rgba(255,255,255,.35); color:#fff; width:34px; height:34px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; }
        .sidebar-collapse-btn i { transition: transform .25s ease; }
        body.sidebar-collapsed .sidebar-collapse-btn i { transform:rotate(180deg); }
        .sidebar .menu { list-style:none; margin:0; padding:.5rem .75rem; }
        .sidebar .menu li { margin-bottom:.35rem; }
        .sidebar .menu a { position:relative; display:flex; align-items:center; gap:12px; padding:.65rem .9rem; color:rgba(255,255,255,.95); text-decoration:none; border-radius:12px; transition: background .2s ease, transform .2s ease, color .2s ease; }
        .sidebar .menu a:hover { background:rgba(255,255,255,.10); transform:translateX(3px); }
        .sidebar .menu a.active { background:rgba(255,255,255,.16); box-shadow: inset 0 0 0 1px rgba(255,255,255,.20); }
        .sidebar .menu a.active::before { content:""; position:absolute; left:-6px; top:10px; bottom:10px; width:3px; border-radius:3px; background:#fff; }
        .sidebar .menu a .icon { width:22px; min-width:22px; text-align:center; opacity:.95; }
        .sidebar::-webkit-scrollbar { width:8px; } .sidebar::-webkit-scrollbar-track{ background:rgba(255,255,255,.08); border-radius:8px; } .sidebar::-webkit-scrollbar-thumb{ background:rgba(0,0,0,.25); border-radius:8px; } .sidebar::-webkit-scrollbar-thumb:hover{ background:rgba(0,0,0,.35); }
        .content-wrapper { margin-left:260px; transition: margin-left .25s ease; padding-top:56px; }
        @media (max-width:991.98px){ .sidebar{ transform:translateX(-100%); transition: transform .25s ease; } .sidebar.open{ transform:translateX(0); } .content-wrapper{ margin-left:0; padding-top:56px; } .content-wrapper.shifted{ margin-left:260px; } }
        .sidebar-overlay { position:fixed; inset:0; background:rgba(0,0,0,.25); z-index:1015; display:none; }
        .sidebar-overlay.show { display:block; }
        /* User avatar */
        .avatar { width:48px; height:48px; border-radius:50%; background:rgba(255,255,255,.15); color:#fff; display:inline-flex; align-items:center; justify-content:center; font-weight:700; letter-spacing:.5px; text-transform:uppercase; border:1px solid rgba(255,255,255,.35); user-select:none; }
        .avatar-btn.dropdown-toggle::after { display:none; }
        .avatar-menu .dropdown-menu { min-width:220px; }
        .avatar-menu .dropdown-header { font-weight:600; }
        .avatar-menu .badge { font-size:.7rem; }
        /* Settings specific styles */
        .settings-card { background:#fff; border-radius:16px; padding:1.25rem; box-shadow:0 6px 18px rgba(0,0,0,.08); margin-bottom:1.5rem; }
        .settings-card .card-title { font-weight:700; margin-bottom:1rem; display:flex; align-items:center; gap:10px; }
        .form-check-input:checked { background-color:var(--primary-color); border-color:var(--primary-color); }
    </style>
</head>
<body>
    <!-- Top Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <button class="btn btn-outline-light btn-sm me-2 d-lg-none" type="button" onclick="toggleSidebar()" title="Menu">
                <i class="fas fa-bars"></i>
            </button>
            <div class="ms-auto navbar-nav align-items-center avatar-menu">
                <div class="dropdown">
                    <button class="btn avatar-btn p-0" type="button" id="avatarDropdown" data-bs-toggle="dropdown" aria-expanded="false" title="Account">
                        <div class="avatar" id="navAvatar">SA</div>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="avatarDropdown">
                        <li><h6 class="dropdown-header" id="avatarUsername">Super Admin</h6></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>Profile</a></li>
                        <li><a class="dropdown-item" href="settings.html"><i class="fas fa-cog me-2"></i>Settings</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside class="sidebar" id="appSidebar">
        <div class="sidebar-header">
            <img src="image/logoe.png" alt="Smart Hotel Logo" class="brand-logo">
            <span class="brand-name">Smart Hotel</span>
            <button class="btn sidebar-collapse-btn d-none d-lg-inline-flex" type="button" onclick="toggleSidebarCollapsed()" title="Collapse/Expand">
                <i class="fas fa-angles-left"></i>
            </button>
        </div>
        <ul class="menu">
            <li><a href="dashboard.html"><span class="icon"><i class="fas fa-gauge"></i></span><span class="label">Dashboard</span></a></li>
            <li><a href="rooms.html"><span class="icon"><i class="fas fa-bed"></i></span><span class="label">Rooms</span></a></li>
            <li><a href="bookings.html"><span class="icon"><i class="fas fa-calendar-check"></i></span><span class="label">Bookings</span></a></li>
            <li><a href="clients.html"><span class="icon"><i class="fas fa-users"></i></span><span class="label">Clients</span></a></li>
            <li><a href="employees.html"><span class="icon"><i class="fas fa-user-tie"></i></span><span class="label">Employees</span></a></li>
            <li><a href="reports.html"><span class="icon"><i class="fas fa-chart-line"></i></span><span class="label">Reports</span></a></li>
            <li><a href="contact.html"><span class="icon"><i class="fas fa-envelope"></i></span><span class="label">Contact</span></a></li>
            <li><a href="settings.html" class="active"><span class="icon"><i class="fas fa-cog"></i></span><span class="label">Settings</span></a></li>
        </ul>
    </aside>
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Content -->
    <div class="content-wrapper" id="contentWrapper">
        <div class="container mt-4">
            <h3 class="mb-4">Settings</h3>
            <div class="row">
                <div class="col-lg-6">
                    <!-- Appearance Card -->
                    <div class="settings-card">
                        <h5 class="card-title"><i class="fas fa-paint-brush"></i> Appearance</h5>
                        <div class="mb-3">
                            <label for="languageSelect" class="form-label">Language</label>
                            <select class="form-select" id="languageSelect">
                                <option value="en">English</option>
                                <option value="ar">العربية</option>
                                <option value="fr">Français</option>
                            </select>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" role="switch" id="darkModeSwitch">
                            <label class="form-check-label" for="darkModeSwitch">Dark Mode</label>
                        </div>
                    </div>

                    <!-- Notifications Card -->
                    <div class="settings-card">
                        <h5 class="card-title"><i class="fas fa-bell"></i> Notifications</h5>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" role="switch" id="emailNotifSwitch" checked>
                            <label class="form-check-label" for="emailNotifSwitch">Email Notifications</label>
                        </div>
                        <div class="form-check form-switch mt-2">
                            <input class="form-check-input" type="checkbox" role="switch" id="pushNotifSwitch">
                            <label class="form-check-label" for="pushNotifSwitch">Push Notifications</label>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <!-- Data Management Card -->
                    <div class="settings-card">
                        <h5 class="card-title"><i class="fas fa-database"></i> Data Management</h5>
                        <div class="mb-3">
                            <label class="form-label">Backup</label><br>
                            <button class="btn btn-primary"><i class="fas fa-download me-2"></i>Create Backup</button>
                        </div>
                        <div class="mb-3">
                            <label for="importFile" class="form-label">Import Data</label>
                            <input class="form-control" type="file" id="importFile">
                        </div>
                        <div>
                            <label class="form-label">Export Data</label><br>
                            <button class="btn btn-secondary"><i class="fas fa-upload me-2"></i>Export as CSV</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Auth check
        checkAuthentication();

        async function checkAuthentication(){
            try{
                const response = await fetch('../backend/check_super_admin_session.php');
                const data = await response.json();
                if(!data.authenticated){ window.location.href='login.html'; return; }
                const username = (data.user && data.user.username) ? String(data.user.username) : 'User';
                const initials = username.split(/\s+|_/).filter(Boolean).slice(0,2).map(w=>w[0]).join('').toUpperCase();
                const avatarEl = document.getElementById('navAvatar');
                if(avatarEl){ avatarEl.textContent = initials || 'U'; avatarEl.title = username; }
                const avatarUsername = document.getElementById('avatarUsername');
                if(avatarUsername) avatarUsername.textContent = username;
            }catch(e){ console.error('Authentication check failed:', e); window.location.href='login.html'; }
        }

        // Sidebar controls
        function toggleSidebar(){
            const sidebar = document.getElementById('appSidebar');
            const content = document.getElementById('contentWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if(!sidebar||!content) return;
            sidebar.classList.toggle('open');
            content.classList.toggle('shifted');
            if(overlay) overlay.classList.toggle('show');
        }
        function closeSidebar(){
            const sidebar = document.getElementById('appSidebar');
            const content = document.getElementById('contentWrapper');
            const overlay = document.getElementById('sidebarOverlay');
            if(!sidebar||!content) return;
            sidebar.classList.remove('open');
            content.classList.remove('shifted');
            if(overlay) overlay.classList.remove('show');
        }
        function applySidebarCollapsed(collapsed){
            document.body.classList.toggle('sidebar-collapsed', !!collapsed);
            try{ localStorage.setItem('sidebarCollapsed', collapsed ? '1' : '0'); }catch(e){}
        }
        function toggleSidebarCollapsed(){
            const collapsed = !document.body.classList.contains('sidebar-collapsed');
            applySidebarCollapsed(collapsed);
        }
        (function initSidebarCollapsed(){
            try{ const saved = localStorage.getItem('sidebarCollapsed'); if(saved==='1') applySidebarCollapsed(true); }catch(e){}
        })();

        async function logout(){
            if(confirm('Are you sure you want to logout?')){
                try{ await fetch('../backend/super_admin_logout.php', { method:'POST' }); }catch(e){ console.error('Logout error:', e); }
                window.location.href = 'login.html';
            }
        }

        // Settings functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved settings
            loadSettings();
            
            // Add event listeners
            document.getElementById('languageSelect').addEventListener('change', saveLanguage);
            document.getElementById('darkModeSwitch').addEventListener('change', saveDarkMode);
            document.getElementById('emailNotifSwitch').addEventListener('change', saveNotificationSettings);
            document.getElementById('pushNotifSwitch').addEventListener('change', saveNotificationSettings);
        });

        function loadSettings() {
            // Load language setting
            const savedLanguage = localStorage.getItem('language') || 'en';
            document.getElementById('languageSelect').value = savedLanguage;
            
            // Load dark mode setting
            const darkMode = localStorage.getItem('darkMode') === 'true';
            document.getElementById('darkModeSwitch').checked = darkMode;
            
            // Load notification settings
            const emailNotif = localStorage.getItem('emailNotifications') !== 'false';
            const pushNotif = localStorage.getItem('pushNotifications') === 'true';
            document.getElementById('emailNotifSwitch').checked = emailNotif;
            document.getElementById('pushNotifSwitch').checked = pushNotif;
        }

        function saveLanguage() {
            const language = document.getElementById('languageSelect').value;
            localStorage.setItem('language', language);
            showToast('Language setting saved successfully!');
        }

        function saveDarkMode() {
            const darkMode = document.getElementById('darkModeSwitch').checked;
            localStorage.setItem('darkMode', darkMode);
            showToast('Theme setting saved successfully!');
        }

        function saveNotificationSettings() {
            const emailNotif = document.getElementById('emailNotifSwitch').checked;
            const pushNotif = document.getElementById('pushNotifSwitch').checked;
            localStorage.setItem('emailNotifications', emailNotif);
            localStorage.setItem('pushNotifications', pushNotif);
            showToast('Notification settings saved successfully!');
        }

        function showToast(message) {
            // Create toast element
            const toast = document.createElement('div');
            toast.className = 'toast align-items-center text-white bg-success border-0';
            toast.setAttribute('role', 'alert');
            toast.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            `;
            
            // Add to page
            let toastContainer = document.querySelector('.toast-container');
            if (!toastContainer) {
                toastContainer = document.createElement('div');
                toastContainer.className = 'toast-container position-fixed top-0 end-0 p-3';
                document.body.appendChild(toastContainer);
            }
            toastContainer.appendChild(toast);
            
            // Show toast
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
            
            // Remove after hiding
            toast.addEventListener('hidden.bs.toast', () => {
                toast.remove();
            });
        }
    </script>
</body>
</html>
